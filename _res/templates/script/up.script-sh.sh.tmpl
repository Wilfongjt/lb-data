source ./_conf.sh


# keep stuff from build docker system prune

echo "${LB_DATA_FOLDER}/${LB_DB_PREFIX}_db"
cd ${LB_APP_NAME}/
docker-compose down
docker system prune


docker images
ls
if [ ! -f 'web/.env' ] ; then
  echo "  "
  echo "!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"
  echo "   You must setup an .env file in ${LB_REPONAME}/"
  echo "       Terminating script."
  echo "!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"
  echo "  "
  exit 1
fi

#docker-compose down

echo "${LB_DATA_FOLDER}/${LB_DB_PREFIX}_db"
if [ -d "${LB_DATA_FOLDER}/${LB_DB_PREFIX}_db" ]; then
  echo "Deleting... ${LB_DATA_FOLDER}/${LB_DB_PREFIX}_db"
  rm -rv "${LB_DATA_FOLDER}/${LB_DB_PREFIX}_db"
  echo "... Deleted ${LB_DATA_FOLDER}/${LB_DB_PREFIX}_db"
else
  echo "Not found ${LB_DATA_FOLDER}/${LB_DB_PREFIX}_db"
fi

# build everything from scratch...slow but works
echo "Ready to start app"

docker-compose build

docker-compose up


# show the environment variables
# docker-compose exec web env
