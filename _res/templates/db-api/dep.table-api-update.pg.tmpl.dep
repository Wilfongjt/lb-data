\c [[LB_DB_PREFIX]]_db
-------------------------------
-- Update XXXXYYYY
---------

CREATE OR REPLACE FUNCTION
[[LB_DB_PREFIX]]_schema.[[api-name]](
  _token TEXT,
  _id int,
  [[update-parameters]]
) RETURNS TEXT
AS $$
    Declare rc TEXT;
  BEGIN
    rc := '{"result":-1}';
    if [[LB_DB_PREFIX]]_schema.is_valid_token(_token, '[[tbl-role]]') then
      rc := '{"result":-2}';
      rc := format('{"result":"%s"}',[[LB_DB_PREFIX]]_schema.get_username(_token));
      update [[LB_DB_PREFIX]]_schema.[[tbl-name]]
        set
          [[update-columns]]
          ,usr_updated=CURRENT_TIMESTAMP
        where [[tbl-prefix]]_id=_id;

      if FOUND then
        rc := '{"result":1}';
      end if;
    end if;
    RETURN rc;
  END;

$$ LANGUAGE plpgsql;

GRANT EXECUTE ON FUNCTION
    [[LB_DB_PREFIX]]_schema.[[api-name]](
    [[update-parameter-types]]
    ) TO anonymous;

